#!/usr/bin/env node

const path = require('path')
const go = require('../index.js')

const help = `
  USAGE

      now-go -c <config-file>

      -c  JS or JSON config file path
      -v  Show version
      -h  Show this help message

  CONFIG FILE EXAMPLE

      {
        "/home": "https://github.com/amio/now-go",
        "/": "Yet another tinyurl service",
        "*": "What are you looking for"
      }
`

const args = require('minimist')(process.argv.slice(2), {
  alias: {
    'c': 'config',
    'v': 'version',
    'h': 'help'
  },
  default: {
    'c': process.env.NOW_GO_CONFIG
  }
})

if (args.help) {
  console.log(help)
  process.exit()
}

if (args.version) {
  console.log('v' + require('../package.json').version)
  process.exit()
}

if (args.config) {
  const cfg = require(path.resolve(process.cwd(), args.config))
  go(cfg)
} else {
  console.log(help)
  process.exit(1)
}
